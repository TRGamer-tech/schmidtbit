<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Fact of the day</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Courier New', Courier, monospace; }
        .blink { animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: var(--theme-color); border-radius: 4px; }

        /* THEME VARIABLES - DEFAULT (Matrix Green) */
        :root {
            --theme-color: #22c55e;       /* green-500 */
            --theme-text: #4ade80;        /* green-400 */
            --theme-dim: rgba(34,197,94,0.3);
            --theme-glow: 0 0 20px rgba(34,197,94,0.3);
            --theme-shadow-text: 2px 2px 0px rgba(34,197,94,0.2);
        }

        /* DYNAMIC THEME CLASSES */
        .theme-text { color: var(--theme-text); }
        .theme-text-bold { color: var(--theme-color); }
        .theme-border { border-color: var(--theme-color); }
        .theme-border-dim { border-color: var(--theme-dim); }
        .theme-shadow { box-shadow: var(--theme-glow); }
        .theme-text-shadow { text-shadow: var(--theme-shadow-text); }
        .theme-hover:hover { color: var(--theme-text); text-decoration: underline; }
    </style>
</head>
<body class="theme-text flex items-center justify-center min-h-screen p-4 transition-colors duration-500">

    <div class="max-w-2xl w-full bg-gray-800 border-2 theme-border p-8 rounded-lg theme-shadow flex flex-col gap-6 transition-all duration-500">
        
        <!-- Header -->
        <div class="flex justify-between items-end border-b border-gray-700 pb-4">
            <div>
                <h1 class="text-3xl font-bold uppercase tracking-widest theme-text-bold theme-text-shadow">
                    System.Fact()
                </h1>
                <p id="date-display" class="text-gray-400 text-sm mt-1">Initializing...</p>
            </div>
            <div class="text-xs text-gray-500 text-right">
                STATUS: <span class="theme-text-bold animate-pulse">ONLINE</span><br>
                MODE: <span class="theme-text-bold">READ_ONLY</span>
            </div>
        </div>

        <!-- Main Fact Area -->
        <div class="min-h-[150px] flex flex-col justify-center bg-gray-900/50 p-6 rounded border theme-border-dim">
            <p id="fact-text" class="text-xl leading-relaxed">
                Scanning global archives...
            </p>
            <p id="year-display" class="text-right text-gray-500 font-bold text-2xl mt-4 opacity-0 transition-opacity duration-500">
                <!-- Year goes here -->
            </p>
        </div>

        <!-- Footer / Controls -->
        <div class="pt-4 border-t border-gray-700 flex flex-wrap justify-between items-center gap-4">
            <a id="source-link" href="#" target="_blank" class="text-xs font-bold theme-text-bold theme-hover transition-colors hidden flex items-center gap-2">
                <span>[ READ SOURCE ]</span>
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg>
            </a>
            
            <div class="flex gap-3 ml-auto text-xs text-gray-600">
                // END OF LINE
            </div>
        </div>

    </div>

    <script>
        // --- THEME DETECTION PROTOCOL ---
        (function detectTheme() {
            const root = document.documentElement;
            // Get the parent URL if inside iframe, or current URL parameters
            const referrer = document.referrer || "";
            const currentUrl = window.location.href;
            
            // Your custom Hex: #1d77a3 (RGB: 29, 119, 163)
            // Lighter variant for body text to ensure readability on dark bg: #63b3ed (Tailwind blue-400ish)
            
            if (referrer.includes("helpdesk.pcetera.ch") || currentUrl.includes("theme=blue")) {
                console.log("Helpdesk Protocol Detected: Engaging Blue Theme.");
                root.style.setProperty('--theme-color', '#1d77a3');       // Main Accent
                root.style.setProperty('--theme-text', '#63b3ed');        // Body Text (Lighter for contrast)
                root.style.setProperty('--theme-dim', 'rgba(29, 119, 163, 0.3)');
                root.style.setProperty('--theme-glow', '0 0 20px rgba(29, 119, 163, 0.3)');
                root.style.setProperty('--theme-shadow-text', '2px 2px 0px rgba(29, 119, 163, 0.2)');
            }
        })();

        // Refined Tech keywords - Keeping strict filters
        const TECH_KEYWORDS = [
            "computer", "internet", "world wide web", "software", "hardware", "microchip", 
            "microprocessor", "cpu", "gpu", "ram", "algorithm", "cyber", "digital", 
            "server", "network", "interface", "pixel", "artificial intelligence", 
            "neural network", "machine learning", "apple inc", "macintosh", "microsoft", 
            "ibm", "google", "amazon.com", "facebook", "linux", "unix", "ubuntu", 
            "transistor", "silicon valley", "semiconductor", "telecom", "wireless", 
            "bluetooth", "wi-fi", "wifi", "ethernet", "email", "e-mail", "smartphone", 
            "iphone", "android", "browser", "operating system", "database", 
            "programming language", "source code", "open source", "videogame", "video game", 
            "nintendo", "sega", "atari", "playstation", "xbox", "cloud computing", "virtual reality",
            "supercomputer", "mainframe", "firewall", "encryption", "cryptography"
        ];

        // Exclude Space stuff explicitly
        const EXCLUDED_KEYWORDS = [
            "river", "forest", "jungle", // Amazon
            "fruit", "beatles", "corps", // Apple
            "biological", "disease", "outbreak", "pandemic", // Virus/Bug
            "legal code", "da vinci", // Code
            "military intelligence", "cia", "fbi", "spy", // Intelligence
            "spider", // Web
            // Space Exclusions
            "space shuttle", "spacecraft", "astronaut", "cosmonaut", "rocket", "orbit", 
            "mars", "moon", "solar system", "galaxy", "telescope", "space station", 
            "apollo", "soyuz", "gemini", "skylab", "mir ", "iss", "interstellar"
        ];

        // Expanded Backup facts database with URLs (Doubled the count)
        const BACKUP_FACTS = [
            { text: "The first computer mouse was made of wood.", year: "1964", url: "https://en.wikipedia.org/wiki/Computer_mouse" },
            { text: "The first 1GB hard drive was announced by IBM. It weighed over 500 pounds and cost $40,000.", year: "1980", url: "https://en.wikipedia.org/wiki/IBM_3380" },
            { text: "Email actually existed before the World Wide Web.", year: "1971", url: "https://en.wikipedia.org/wiki/Email#Origin" },
            { text: "The Firefox logo is actually a red panda, not a fox.", year: "2004", url: "https://en.wikipedia.org/wiki/Firefox#Branding_and_visual_identity" },
            { text: "The first webcam was created at Cambridge University to check the status of a coffee pot.", year: "1991", url: "https://en.wikipedia.org/wiki/Trojan_Room_coffee_pot" },
            { text: "Nintendo was founded as a playing card company.", year: "1889", url: "https://en.wikipedia.org/wiki/History_of_Nintendo" },
            { text: "The first computer bug was an actual real-life moth stuck in a relay of the Harvard Mark II.", year: "1947", url: "https://en.wikipedia.org/wiki/Software_bug#Etymology" },
            { text: "The very first domain name ever registered was symbolics.com.", year: "1985", url: "https://en.wikipedia.org/wiki/Symbolics.com" },
            { text: "CAPTCHA stands for 'Completely Automated Public Turing test to tell Computers and Humans Apart'.", year: "2003", url: "https://en.wikipedia.org/wiki/CAPTCHA" },
            { text: "The QWERTY keyboard was originally designed to slow down typists so mechanical typewriter keys would not jam.", year: "1873", url: "https://en.wikipedia.org/wiki/QWERTY" },
            { text: "WiFi technology was partly invented by Hollywood actress Hedy Lamarr during WWII.", year: "1942", url: "https://en.wikipedia.org/wiki/Hedy_Lamarr#Invention" },
            { text: "The first text message ever sent simply said 'Merry Christmas'.", year: "1992", url: "https://en.wikipedia.org/wiki/SMS#History" },
            { text: "More than 90% of the world's currency exists only on computers.", year: "2023", url: "https://en.wikipedia.org/wiki/Digital_currency" },
            { text: "The programming language Python was named after 'Monty Python's Flying Circus', not the snake.", year: "1991", url: "https://en.wikipedia.org/wiki/Python_(programming_language)#History" },
            { text: "The first alarm clock could only ring at 4 a.m.", year: "1787", url: "https://en.wikipedia.org/wiki/Alarm_clock" },
            { text: "Samsung was 38 years old and selling dried fish and noodles before it started making electronics.", year: "1938", url: "https://en.wikipedia.org/wiki/Samsung#History" },
            { text: "The first banner ad ever clicked had a Click-Through Rate (CTR) of 44%.", year: "1994", url: "https://en.wikipedia.org/wiki/Web_banner#History" },
            { text: "Google's original name was 'Backrub' because it analyzed backlinks.", year: "1996", url: "https://en.wikipedia.org/wiki/Google#History" },
            { text: "The very first YouTube video was titled 'Me at the zoo' and is 18 seconds long.", year: "2005", url: "https://en.wikipedia.org/wiki/Me_at_the_zoo" },
            { text: "Bluetooth is named after King Harald Bluetooth who united dissident Danish tribes.", year: "1997", url: "https://en.wikipedia.org/wiki/Bluetooth#Etymology" },
            { text: "The first photo ever uploaded to the web was of a comedy band called Les Horribles Cernettes.", year: "1992", url: "https://en.wikipedia.org/wiki/Les_Horribles_Cernettes" },
            { text: "The first mobile phone call was made by Martin Cooper of Motorola to his rival at Bell Labs.", year: "1973", url: "https://en.wikipedia.org/wiki/Martin_Cooper_(inventor)" },
            { text: "The first hard drive, the IBM 305 RAMAC, held only 5MB of data and had to be moved by forklift.", year: "1956", url: "https://en.wikipedia.org/wiki/IBM_305_RAMAC" },
            { text: "There is a 3D-printed castle on a grain of sand created by researchers.", year: "2022", url: "https://en.wikipedia.org/wiki/3D_printing" },
            { text: "The original Xbox contained snippets of actual transmissions from the Apollo space missions.", year: "2001", url: "https://en.wikipedia.org/wiki/Xbox_(console)" },
            { text: "Spacewar!, widely considered the first computer video game, was written at MIT.", year: "1962", url: "https://en.wikipedia.org/wiki/Spacewar!" },
            { text: "The first computer virus, Creeper, simply displayed the message: 'I'm the creeper, catch me if you can!'", year: "1971", url: "https://en.wikipedia.org/wiki/Creeper_(program)" },
            { text: "Amazon's first name was 'Cadabra', but Jeff Bezos changed it because it sounded like 'cadaver'.", year: "1994", url: "https://en.wikipedia.org/wiki/Amazon_(company)#History" },
            { text: "The first Apple logo featured Isaac Newton sitting under an apple tree.", year: "1976", url: "https://en.wikipedia.org/wiki/Apple_Inc.#Logo" },
            { text: "The computing power inside a modern smartphone is millions of times greater than the Apollo guidance computer.", year: "1969", url: "https://en.wikipedia.org/wiki/Apollo_Guidance_Computer" }
        ];

        // Strict "No Ess-Tsett" Policy
        function sanitizeText(text) {
            return text.replace(/ÃŸ/g, 'ss');
        }

        async function loadFact() {
            const factText = document.getElementById('fact-text');
            const yearDisplay = document.getElementById('year-display');
            const dateDisplay = document.getElementById('date-display');
            const sourceLink = document.getElementById('source-link');
            
            // UI Reset
            factText.innerHTML = '<span class="animate-pulse">Accessing daily log...</span>';
            yearDisplay.classList.add('opacity-0');
            sourceLink.classList.add('hidden');

            // Get Current Date
            const today = new Date();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const displayDate = sanitizeText(today.toLocaleDateString('en-US', options));
            
            dateDisplay.innerText = "Target Date: " + displayDate;

            // Speed Hack: Set a timeout controller. If Wikipedia takes > 1.5s, we bail to backup.
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 3000);

            try {
                // Fetch from Wikipedia On This Day API for TODAY
                const response = await fetch(`https://en.wikipedia.org/api/rest_v1/feed/onthisday/events/${month}/${day}`, {
                    signal: controller.signal
                });
                clearTimeout(timeoutId); // Clear timeout if successful

                if (!response.ok) throw new Error("API Failure");
                
                const data = await response.json();
                
                const techEvents = data.events.filter(event => {
                    const content = (event.text + " " + event.pages.map(p => p.title).join(" ")).toLowerCase();
                    
                    const hasKeyword = TECH_KEYWORDS.some(keyword => content.includes(keyword.toLowerCase()));
                    const hasExclusion = EXCLUDED_KEYWORDS.some(keyword => content.includes(keyword.toLowerCase()));
                    
                    return hasKeyword && !hasExclusion;
                });

                if (techEvents.length > 0) {
                    // Pick a random event from TODAY's filtered list
                    const event = techEvents[Math.floor(Math.random() * techEvents.length)];
                    const cleanText = sanitizeText(event.text);
                    
                    factText.innerText = cleanText;
                    yearDisplay.innerText = event.year;
                    yearDisplay.classList.remove('opacity-0');

                    if (event.pages && event.pages[0]) {
                        sourceLink.href = event.pages[0].content_urls.desktop.page;
                        sourceLink.classList.remove('hidden');
                    }
                } else {
                    // If no events found for today, use backup
                    throw new Error("No events found for today");
                }

            } catch (error) {
                console.log("Using backup fact due to: " + error.message);
                const backup = BACKUP_FACTS[Math.floor(Math.random() * BACKUP_FACTS.length)];
                const cleanText = sanitizeText(backup.text);
                
                // Indicate we are on backup without being annoying
                dateDisplay.innerText = displayDate + " [ARCHIVE MODE]";
                factText.innerText = cleanText;
                yearDisplay.innerText = backup.year;
                yearDisplay.classList.remove('opacity-0');

                // Enable source link for backup fact
                if (backup.url) {
                    sourceLink.href = backup.url;
                    sourceLink.classList.remove('hidden');
                }
            }
        }

        // Run immediately to feel faster (don't wait for full window load)
        loadFact();
    </script>
</body>
</html>
